{
  "kind": "build_request",
  "title": "Fix Bulk Upload Unauthorized Error",
  "projectName": "AVT Vashi Member Registration",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-44",
      "text": "Fix the 'Unauthorized: Only users can bulk add members' error that occurs when calling the bulkAddMembers backend function. The backend access control check for bulkAddMembers is incorrectly blocking authenticated users. Inspect the caller identity check in the Motoko actor's bulkAddMembers function and ensure it correctly allows authenticated Internet Identity users (non-anonymous principals) to perform the bulk add operation, consistent with how the addMember function handles access control.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-recent"
        ],
        "quotes": [
          "When I am uploding the data, I am getting an error 'Unauthorized: Only users can bulk add members'."
        ]
      },
      "acceptanceCriteria": [
        "An authenticated Internet Identity user can successfully call bulkAddMembers without receiving an 'Unauthorized' error.",
        "The bulkAddMembers access control check uses the same principal/identity validation logic as the addMember function.",
        "Anonymous (unauthenticated) callers are still rejected with an appropriate error.",
        "The bulk upload flow on BulkUploadPage completes successfully and returns the count of imported members when called by an authenticated user."
      ]
    }
  ],
  "constraints": [
    "Do not change the Member data model or any existing field definitions.",
    "Do not alter the addMember access control logic â€” only align bulkAddMembers to match it."
  ],
  "nonGoals": [
    "Changing the frontend BulkUploadPage UI or CSV parsing logic.",
    "Modifying any other backend functions.",
    "Adding new fields or columns to the member record."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}